<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Mobile Metas -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <!-- Site Metas -->
    <title>Perfect - Responsive HTML5 Template</title>
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta name="author" content="" />

    <!-- Site Icons -->
    <link rel="shortcut icon" href="#" type="image/x-icon" />
    <link rel="apple-touch-icon" href="#" />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <!-- Pogo Slider CSS -->
    <link rel="stylesheet" href="css/pogo-slider.min.css" />
    <!-- Site CSS -->
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/styles.css" />
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="css/responsive.css" />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/custom.css" />

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style>
      .inner_banner {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      h3 {
        display: flex;
        flex-direction: row;
        font-size: 7vw; /* Responsive font size */
        justify-content: center;
        text-align: center;
        flex-wrap: wrap; /* Allows wrapping of text for better responsiveness */
      }

      @media (min-width: 600px) {
        h3 {
          font-size: 4vw;
        }
      }

      @media (min-width: 1200px) {
        h3 {
          font-size: 2.5vw;
        }
      }

      #displayOption2 {
        padding-left: 15px;
      }
    </style>
  </head>
  <body
    id="inner_page"
    data-spy="scroll"
    data-target="#navbar-wd"
    data-offset="98"
  >
    <header class="top-header">
      <nav class="navbar header-nav navbar-expand-lg">
        <div class="container-fluid">
          <a class="navbar-brand" href="/">
            <img src="images/logo.png" alt="image" />
          </a>
          <button
            class="navbar-toggler"
            type="button"
            data-toggle="collapse"
            data-target="#navbar-wd"
            aria-controls="navbar-wd"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span></span>
            <span></span>
            <span></span>
          </button>
          <div
            class="collapse navbar-collapse justify-content-end"
            id="navbar-wd"
          >
            <ul class="navbar-nav">
              <li><a class="nav-link active" href="/">Acceuil</a></li>
              <li><a class="nav-link" href="/about">A propos</a></li>
              <li><a class="nav-link" href="/courses">Séances</a></li>
              <li><a class="nav-link" href="/reaserch">Documents</a></li>
              <li><a class="nav-link" href="/formation">Formations</a></li>
              <li><a class="nav-link" href="/contact">Contact</a></li>
              <% if (loggedIn) { %>
              <li class="nav-item">
                <a class="nav-link" href="/logout">Logout</a>
              </li>
              <% } else { %>
              <li class="nav-item">
                <a class="nav-link" href="/login">Login</a>
              </li>
              <% } %>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <section class="inner_banner">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <div class="full">
              <h3>
                <div>Tous Les Documents de L'institut</div>
                <div style="margin-left: -5px" id="displayOption2"></div>
                <div style="margin-left: 10px">Pour Le Niveau</div>
                <div style="margin-left: 10px" id="displayOption3"></div>
              </h3>
            </div>
          </div>
        </div>
      </div>
    </section>

    <div class="container">
      <main>
        <section class="details">
          <h2>Ce que vous apprendrez</h2>
          <ul>
            <li>
              Apprenez les mathématiques d'algèbre et d'analyse avec des cours
              détaillés et des TD corrigés.
            </li>
            <li>
              Apprenez les bases de données avec des cours détaillés et des TD
              corrigés (SQL , ..)
            </li>
            <li>
              Apprenez l'algorithmique et le langage C avec des cours détaillés
              et des TD corrigés.
            </li>
            <li>
              Apprenez les concepts de réseau et de routage avec des cours
              détaillés et des TD corrigés.
            </li>
            <li>
              Apprenez Linux et les systèmes d'exploitation avec des cours
              détaillés et des TD corrigés.
            </li>
          </ul>
        </section>
        <section class="related-topics">
          <h2>Explorez des sujets connexes</h2>
          <button class="topic-btn">2eme Année</button>
          <button class="topic-btn">3eme Année</button>
        </section>
        <section class="trusted-companies">
          <h2>Les matières incluses dans cette offre</h2>
          <div class="companies">
            <span>Mathématiques</span>
            <span>Algorithmique et Langage C</span>
            <span>Système d'Exploitation</span>
            <span>Réseau</span>
            <span>Base De Données</span>
            <span>Python</span>
            <span>Logique Formelle</span>
            <span>Linux</span>
          </div>
        </section>
      </main>
      <aside class="course-purchase">
        <img src="/images/d17.jpg" />
        <h3>20 TND</h3>
        <button
          class="btn buy-now"
          data-toggle="modal"
          data-target="#exampleModal"
          id="paimentButton"
        >
          Paiment
        </button>
        <div
          class="modal fade"
          id="exampleModal"
          tabindex="-1"
          role="dialog"
          aria-labelledby="exampleModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h4 class="modal-title" id="exampleModalLabel">
                  Suiver Ces Instructions Pour Avoir l'Accés :
                </h4>
                <button
                  type="button"
                  class="close"
                  data-dismiss="modal"
                  aria-label="Close"
                >
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <ol>
                  <li>-Payer 20 TND Vers 29722048 Avec D17</li>

                  <li>
                    <form
                      id="payment-form"
                      method="POST"
                      enctype="multipart/form-data"
                    >
                      <div class="form-group">
                        <label for="recipient-name" class="col-form-label"
                          >Votre Numéro De Téléphone:</label
                        >
                        <input
                          type="text"
                          class="form-control"
                          id="recipient-name"
                          name="num"
                        />
                      </div>

                      <div class="mb-3">
                        <label for="formFile" class="form-label"
                          >Voici un exemple de numéro d'autorisation de reçu
                          :</label
                        >
                        <img src="/images/cap.png" alt="" />
                      </div>

                      <div class="form-group">
                        <label for="recipient-name" class="col-form-label"
                          >Entrer Le Numéro D'authorisation De Récu:</label
                        >
                        <input
                          name="aut"
                          type="text"
                          class="form-control"
                          id="recipient-name"
                        />
                      </div>

                      <li>
                        S'il y a un problème, contactez-nous ici :
                        <a href="https://www.facebook.com" target="_blank"
                          >Facebook</a
                        >
                      </li>

                      <button type="submit" class="btn btn-primary">
                        Confirmer
                      </button>
                      <div class="modal-footer">
                        <button
                          type="button"
                          class="btn btn-secondary"
                          data-dismiss="modal"
                        >
                          Fermer
                        </button>
                      </div>
                    </form>
                  </li>
                </ol>
              </div>
            </div>
          </div>
        </div>
        <button class="btn buy-now" id="accessButton" disabled>Accéder</button>

        <div class="course-includes">
          <h4>Ce cours comprend :</h4>
          <ul>
            <li>Documents organisés</li>
            <li>Exercices et TD corrigés</li>
            <li>+6 Matières</li>
            <li>Ressources téléchargeables</li>
            <li>Accès Avec Drive</li>
            <li>Accès à vie complet</li>
          </ul>
        </div>
        <div class="apply-coupon">
          <input type="text" placeholder="Entrer Coupon" />
          <button class="btn apply">Appliquer</button>
        </div>
      </aside>
    </div>

    <!-- Start Footer -->
    <footer class="footer-box">
      <div class="container">
        <div class="row">
          <div class="col-xs-12 col-sm-6 col-md-6 col-lg-3">
            <div class="footer_blog">
              <div class="full margin-bottom_30">
                <img src="images/footer_logo.png" alt="#" />
              </div>
              <div class="full white_fonts">
                <p>
                  Bienvenue sur notre plateforme éducative ! Nous proposons une
                  vaste gamme de documents pédagogiques et organisons des
                  sessions en direct pour les étudiants.
                </p>
              </div>
            </div>
          </div>

          <div class="col-xs-12 col-sm-6 col-md-6 col-lg-3">
            <div class="footer_blog footer_menu white_fonts">
              <h3>Navigation</h3>
              <ul>
                <li><a href="./courses.html">> Cours</a></li>
                <li><a href="./contact.html">> Contact</a></li>
                <li><a href="./reaserch.html">>Documents</a></li>
                <li><a href="./formation.html">>Formation</a></li>
                <li><a href="./about.html">>A propos</a></li>
              </ul>
            </div>
          </div>

          <div class="col-xs-12 col-sm-6 col-md-6 col-lg-3">
            <div class="footer_blog full white_fonts">
              <h3>Newsletter</h3>

              <div class="newsletter_form">
                <form action="/">
                  <input type="email" placeholder="Email" name="#" required />
                  <button>Submit</button>
                </form>
              </div>
            </div>
          </div>

          <div class="col-xs-12 col-sm-6 col-md-6 col-lg-3">
            <div class="footer_blog full white_fonts">
              <h3>Contact</h3>
              <ul class="full">
                <li>
                  <img src="images/i5.png" /><span>Nabeul<br />Tunisie</span>
                </li>
                <li><img src="images/i6.png" /><span>email@gmail.com</span></li>
                <li><img src="images/i7.png" /><span>+21629722048</span></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <!-- End Footer -->

    <a href="#" id="scroll-to-top" class="hvr-radial-out"
      ><i class="fa fa-angle-up"></i
    ></a>

    <!-- ALL JS FILES -->

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const option2 = localStorage.getItem("option2");
        const option3 = localStorage.getItem("option3");

        function checkAccess() {
          fetch("/api/check-request-status")
            .then((response) => response.json())
            .then((data) => {
              let accessGranted = false;

              data.forEach((item) => {
                if (
                  item.status === "accepted" &&
                  item.option2 === option2 &&
                  item.option3 === option3
                ) {
                  accessGranted = true;
                  document.getElementById("accessButton").disabled = false;
                  document.getElementById("accessButton").onclick =
                    function () {
                      window.open(
                        "https://drive.google.com/drive/u/3/home",
                        "_blank"
                      );
                    };
                  // Exit the loop as we found a matching request
                  return;
                }
              });

              if (!accessGranted) {
                document.getElementById("accessButton").disabled = true;
              }
            })
            .catch((error) => {
              console.error("Error:", error);
            });
        }

        checkAccess();

        document.getElementById("displayOption2").textContent = option2;
        document.getElementById("displayOption3").textContent = option3;

        document
          .getElementById("payment-form")
          .addEventListener("submit", function (event) {
            event.preventDefault();

            const form = event.target;
            const formData = new FormData(form);

            // Convert FormData to JSON
            const jsonObject = {};
            formData.forEach((value, key) => {
              jsonObject[key] = value;
            });

            // Add extra fields to JSON
            jsonObject["option2"] = option2;
            jsonObject["option3"] = option3;

            fetch("/cards", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(jsonObject),
            })
              .then((response) => response.text())
              .then((data) => {
                alert(data); // Handle success message
              })
              .catch((error) => {
                console.error("Error:", error);
              });
          });
      });
    </script>

    <script src="js/jquery.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!-- ALL PLUGINS -->
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/jquery.pogo-slider.min.js"></script>
    <script src="js/slider-index.js"></script>
    <script src="js/smoothscroll.js"></script>
    <script src="js/form-validator.min.js"></script>
    <script src="js/contact-form-script.js"></script>
    <script src="js/isotope.min.js"></script>
    <script src="js/images-loded.min.js"></script>
    <script src="js/custom.js"></script>
    <script>
      /* counter js */

      (function ($) {
        $.fn.countTo = function (options) {
          options = options || {};

          return $(this).each(function () {
            // set options for current element
            var settings = $.extend(
              {},
              $.fn.countTo.defaults,
              {
                from: $(this).data("from"),
                to: $(this).data("to"),
                speed: $(this).data("speed"),
                refreshInterval: $(this).data("refresh-interval"),
                decimals: $(this).data("decimals"),
              },
              options
            );

            // how many times to update the value, and how much to increment the value on each update
            var loops = Math.ceil(settings.speed / settings.refreshInterval),
              increment = (settings.to - settings.from) / loops;

            // references & variables that will change with each update
            var self = this,
              $self = $(this),
              loopCount = 0,
              value = settings.from,
              data = $self.data("countTo") || {};

            $self.data("countTo", data);

            // if an existing interval can be found, clear it first
            if (data.interval) {
              clearInterval(data.interval);
            }
            data.interval = setInterval(updateTimer, settings.refreshInterval);

            // initialize the element with the starting value
            render(value);

            function updateTimer() {
              value += increment;
              loopCount++;

              render(value);

              if (typeof settings.onUpdate == "function") {
                settings.onUpdate.call(self, value);
              }

              if (loopCount >= loops) {
                // remove the interval
                $self.removeData("countTo");
                clearInterval(data.interval);
                value = settings.to;

                if (typeof settings.onComplete == "function") {
                  settings.onComplete.call(self, value);
                }
              }
            }

            function render(value) {
              var formattedValue = settings.formatter.call(
                self,
                value,
                settings
              );
              $self.html(formattedValue);
            }
          });
        };

        $.fn.countTo.defaults = {
          from: 0, // the number the element should start at
          to: 0, // the number the element should end at
          speed: 1000, // how long it should take to count between the target numbers
          refreshInterval: 100, // how often the element should be updated
          decimals: 0, // the number of decimal places to show
          formatter: formatter, // handler for formatting the value before rendering
          onUpdate: null, // callback method for every time the element is updated
          onComplete: null, // callback method for when the element finishes updating
        };

        function formatter(value, settings) {
          return value.toFixed(settings.decimals);
        }
      })(jQuery);

      jQuery(function ($) {
        // custom formatting example
        $(".count-number").data("countToOptions", {
          formatter: function (value, options) {
            return value
              .toFixed(options.decimals)
              .replace(/\B(?=(?:\d{3})+(?!\d))/g, ",");
          },
        });

        // start all the timers
        $(".timer").each(count);

        function count(options) {
          var $this = $(this);
          options = $.extend(
            {},
            options || {},
            $this.data("countToOptions") || {}
          );
          $this.countTo(options);
        }
      });
    </script>
    <script>
      const traitement = "En Cours De Révision";
      function checkRequestWaiting() {
        fetch("/api/check-request-waiting")
          .then((response) => response.json())
          .then((data) => {
            console.log(data);
            if (data.hasRequest) {
              document.getElementById("paimentButton").disabled = true;
              document.getElementById("paimentButton").innerText = traitement;
            } else {
              document.getElementById("paimentButton").disabled = false;
            }
          })
          .catch((error) => {
            console.error("Error:", error);
          });
      }

      // Call the function to check the request status
      checkRequestWaiting();
    </script>
  </body>
</html>
